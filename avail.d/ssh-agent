#
# ~/.bashrc-avail.d/ssh-agent
# $Id$
#
# another strategy (http://unix.stackexchange.com/questions/90853/how-can-i-run-ssh-add-automatically-without-password-prompt)
#

# start agent if none running
if [ ! -S ~/.ssh/ssh_auth_sock ]; then
	eval `ssh-agent`
	ln -sf "$SSH_AUTH_SOCK" ~/.ssh/ssh_auth_sock
fi
export SSH_AUTH_SOCK=~/.ssh/ssh_auth_sock

# if no keys, add some
ssh-add -l | grep "The agent has no identities" \
	&& ssh-add -t23h59m `find ~/.ssh -type f -name id_\* -and -not -name id_\*.pub`

